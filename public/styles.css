/* ===========================
   EMUDriverTraining ‚Äî styles
   =========================== */

/* ---- Âü∫Êú¨‰ΩàÊôØ ---- */
:root{
  --bg:#0b0c0f;
  --panel:#11131a;
  --fg:#0e1524;
  --fg-invert:#e7eaf3;
  --muted:#6b778d;
  --muted-invert:#9aa3b2;
  --line:#dfe3ee;
  --line-invert:#2a3142;
  --accent:#7aa2ff;

  --radius:14px;
  --maxw:none;

  /* Áµ±‰∏ÄÁ∏ÆÊéíÂèÉÊï∏ */
  --indent: 28px;

  /* ÊäòÁñäÊ®πÁãÄË¶ñË¶∫ */
  --gutter: 20px;
  --rail-w: 1.5px;
  --bullet-size: 8px;
  --rail: #dbe1f1;
  --bullet: #6b778d;

  /* Ê∞¥Âπ≥ / ÂûÇÁõ¥ÂæÆË™ø */
  --bullet-nudge-x: -2px;
  --bullet-nudge-y: 0px;

  /* Áõ¥Á∑öÁ´ØÈªûËàáÂúìÈªûÁöÑÂÆâÂÖ®Ë∑ùÔºàÈÅøÂÖçÁ©øÂá∫ÂúìÈªûÔºâ */
  --rail-cap: -5px;

  /* hover È°èËâ≤ */
  --heading-hover:#9ec5ff;

  /* Âè™ÈáùÂ∞çÁ¨¨‰∏ÄÂ±§Á¥öÂúìÈªûÁöÑÈ°çÂ§ñÂûÇÁõ¥ÂæÆË™øÔºàÊ≠£Êï∏=ÂæÄ‰∏ãÔºâ */
  --bullet-nudge-y-l1: 1px;

  /* ===== ÂãïÁï´ tokens ===== */
  --ease-smooth: cubic-bezier(.22,.61,.36,1);
  --dur-fast: 160ms;     /* opacity/Â∞èËÆäÂåñ */
  --dur-med: 200ms;      /* È´òÂ∫¶ÂãïÁï´ 180‚Äì220ms ‰πãÈñì */
}

@media (prefers-color-scheme: dark){
:root{
  --fg:#e7eaf3;
  --muted:#9aa3b2;
  --line:#262b36;
  --rail:#2a3142;
  --bullet:#9aa3b2;
  --heading-hover:#009AFF;
}
}

@media (prefers-reduced-motion: reduce){
  :root{
    --dur-fast: 1ms;
    --dur-med: 1ms;
  }
}

html,body{
  height:100%;
  overflow-x: auto;
  overflow-y: auto;
}
body{
  margin:0;
  color:var(--fg);
  font:16px/1.65 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans TC",sans-serif;
  background:#fff;
}
@media (prefers-color-scheme: dark){
  body{ background:linear-gradient(180deg,var(--bg),#0f131d); }
}

/* ÂÖÅË®±ÂÖßÂÆπÊ∞¥Âπ≥Âª∂‰º∏ */
.wrap{
  max-width: none;
  margin:0 auto;
  padding:20px 16px 60px;
  overflow-x: auto;
  overflow-y: visible;
}

/* ÂèØ‰æùÈúÄÊ±ÇÈö±ËóèÈ†ÅÈ¶ñËàáÊ®ôÈ°åÂàó */
.hdr{ display:none; }
.titlebar{ display:none; }

/* Âç°ÁâáÂÆπÂô® */
.card{
  background: transparent;
  border: none;
  border-radius: 0;
  box-shadow: none;
  overflow: visible;
  min-width: min-content;
  width: fit-content;
}
@media (prefers-color-scheme: dark){
  .card{ background: transparent; border: none; }
}
.content{
  padding: 0;
  min-width: min-content;
  width: fit-content;
  overflow: visible;
}

/* Markdown ÊñáÂ≠óÊéíÁâàÔºàÁ≤æÁ∞°Ôºâ */
.md-root h1{
  font-size:28px;
  margin:12px 0 14px;
  max-width: 80vw;
  word-wrap: break-word;
  overflow-wrap: break-word;
}
.md-root p{
  margin:10px 0;
  max-width: 80vw;
  word-wrap: break-word;
  overflow-wrap: break-word;
  white-space: normal;
}
.md-root img{
  max-width: 80vw;
  height:auto;
  display:block;
  margin:10px auto;
  border-radius:8px;
}
pre{
  background:#0001;
  padding:12px;
  border-radius:8px;
  max-width: 80vw;
  overflow-x: auto;
  word-wrap: break-word;
}

/* ÂèñÊ∂àÁÄèË¶ΩÂô®È†êË®≠Ê∏ÖÂñÆÁ∏ÆÊéíÔºå‰∫§Áµ¶ .section ÊéßÂà∂Á∏ÆÊéí */
.md-root ul, .md-root ol{
  list-style-position: outside;
  padding-left: 0;
  margin-left: 0;
}

/* ===========================
   Roam È¢®Ê®πÁãÄ
   =========================== */

.section{
  position: relative;
  margin-left: var(--indent);
  padding-left: var(--gutter);
  min-width: fit-content;
}
.section[style*="--depth: 0"]{
  margin-left: 0;
}

.section-body{
  position: relative;
  min-width: fit-content;
}

/* Â∞éËªå */
.section-body::before{
  content:"";
  position:absolute;
  left: calc(-1 * var(--gutter) + (var(--gutter) / 2) - (var(--rail-w) / 2) + 4px);
  top: var(--rail-cap);
  bottom: var(--rail-cap);
  width: var(--rail-w);
  background: var(--rail);
  pointer-events: none;
  z-index: 0;
  display: none;
}
.section.expanded.has-children > .section-body::before{
  display: block;
}

/* ===== Â∞éËªåËÑàË°ùÔºàÂ±ïÈñãÊôÇ 600ms ‰∏ÄÊ¨°Ôºâ ===== */
@keyframes railPulse {
  0% { opacity: .0; }
  30% { opacity: .7; }
  100% { opacity: .3; }
}
.section-body.pulse::before{
  animation: railPulse 600ms var(--ease-smooth) 1;
}

/* Ê®ôÈ°åÂàóÔºàÂúìÈªûËàáÊñáÂ≠óÔºâ */
.section > [role="heading"]{
  position: relative;
  z-index: 1;
  transition: color .15s ease;
  max-width: none;
  word-wrap: break-word;
  overflow-wrap: break-word;
  white-space: normal;
  min-width: fit-content;

  /* ÈóúÈçµÔºöËÆìÂúìÈªû‰ª•„ÄåÁ¨¨‰∏ÄË°å„ÄçÁÇ∫Âü∫Ê∫ñ */
  align-items: flex-start;
}

/* üîï ÂúñÁâáÊ®ôÈ°åÁöÑÂúìÈªû„ÄåÈö±Ëóè‰ΩÜ‰øùÁïô‰ΩçÁΩÆ„Äç */
.section.image-heading > [role="heading"]::before{
  visibility: hidden; /* Âè™Èö±ËóèÔºå‰∏çÁßªÈô§‰ΩàÂ±ÄÁ©∫Èñì */
}

/* È°çÂ§ñ‰øùÈö™ÔºàÊîØÊè¥ :has ÁöÑÁÄèË¶ΩÂô®Ôºâ‚Äî‚Äî Ëã•Ê®ôÈ°åÂè™Êúâ‰∏ÄÂºµÂúñÁâá‰πüÈö±ËóèÂúìÈªû */
.section > [role="heading"]:has(> img:only-child)::before,
.section > [role="heading"]:has(> p:only-child > img:only-child)::before{
  visibility: hidden;
}

/* Âè™‰øÆÊ≠£„ÄåÁ¨¨‰∏ÄÂ±§Á¥ö„ÄçÂúìÈªûÁöÑÂûÇÁõ¥ÁΩÆ‰∏≠ÂæÆË™øÔºà‰∏çÂΩ±ÈüøÂÖ∂‰ªñÂ±§Á¥öÔºâ */
.section[style*="--depth: 0"] > [role="heading"]::before{
  margin-top: calc(
    (var(--h-sub-line-height) * 1em - var(--bullet-size)) / 2
    + var(--bullet-nudge-y-l1, 1px)
  );
}

/* hover ÊïàÊûú */
.section.has-children > [role="heading"]:hover,
.section.has-children > [role="heading"]:focus-visible{
  color: var(--heading-hover);
  outline: none;
}

/* ===== Ê®ôÈ°å„ÄåÈ´ò‰∫ÆÊ∂àÈÄÄ„ÄçÔºöÊñ∞Â±ïÈñãÁØÄÈªû 800ms ÊüîÂÖâ ===== */
.section.just-opened > [role="heading"]{
  position: relative;
}
.section.just-opened > [role="heading"]::after{
  content:"";
  position:absolute; inset:-2px -6px;
  background: currentColor;
  opacity:.08; border-radius:8px; pointer-events:none;
  animation: headGlow 800ms var(--ease-smooth) 1 forwards;
}
@keyframes headGlow{
  from{ opacity:.10; } to{ opacity:0; }
}

/* ===== Â±ïÈñã/Êî∂ÂêàÔºöÁµ≤ÊªëÈ´òÂ∫¶ + Ê∑°ÂÖ• ===== */
.section-body.animating{
  overflow: hidden;
  will-change: height, opacity;
  transition:
    height var(--dur-med) var(--ease-smooth),
    opacity var(--dur-fast) linear;
}
.section.expanded > .section-body{ opacity: 1; }
.section:not(.expanded) > .section-body{ opacity: .0; }

/* Êî∂ÂêàÁãÄÊÖãÔºàÂãïÁï´ÁµêÊùüÂæåÊâçÂä†‰∏äÔºâ */
.section-body.collapsed{ display:none; }

/* ÂÖßÂÆπÂçÄÂ°ä‰∏ä‰∏ãË∑ù */
.section-body > *{ margin-block: .35rem .35rem; }

/* ÂÖßÊñáÂúñÁâáËàáÊÆµËêΩÂØ¨Â∫¶ÈôêÂà∂ */
.section-body img{
  margin-left: .25rem;
  max-width: 80vw;
}
.section-body p,
.section-body > *:not(.section):not(ul):not(ol) {
  max-width: 80vw;
  word-wrap: break-word;
  overflow-wrap: break-word;
  white-space: normal;
}

/* ÂÖßÈÉ® ul/ol */
.section-body ul, .section-body ol{
  padding-left: 0;
  margin-left: 0;
  list-style: none;
}

/* ÂèØËÉΩÊÆòÁïôÁöÑÂéüÁîü li */
.section-body li{
  margin-left: var(--indent);
  word-wrap: break-word;
}

/* ===== Á¥îÂúñÁâáÊ®ôÈ°åÔºöÂΩ±Â≠êÊî∂ÂêàÔºàÂ±ïÈñãÊôÇÊ•µÊ∑°ÂçáËµ∑Ôºâ ===== */
.section.image-heading > [role="heading"] img{
  transition: filter var(--dur-med) var(--ease-smooth),
              transform var(--dur-med) var(--ease-smooth);
  filter: none;
  transform: translateY(0);
}
.section.image-heading.expanded > [role="heading"] img{
  filter: drop-shadow(0 6px 16px rgba(0,0,0,.18));
  transform: translateY(-2px);
}

/* ÈÄ£ÁµêÈ¢®Ê†º */
.md-root a{
  color:var(--accent);
  text-decoration:none;
  word-wrap: break-word;
  overflow-wrap: break-word;
}
.md-root a:hover{ text-decoration:underline; }

/* Êç≤Ëª∏ÁæéÂåñ */
::-webkit-scrollbar { width: 10px; height: 10px; }
::-webkit-scrollbar-track { background: rgba(0,0,0,0.05); }
::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.2); border-radius: 5px; }
::-webkit-scrollbar-thumb:hover { background: rgba(0,0,0,0.3); }

@media (prefers-color-scheme: dark){
  ::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); }
  ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); }
  ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.3); }
}
