/* ===========================
   EMUDriverTraining — styles
   =========================== */

/* ---- 基本佈景 ---- */
:root{
  --bg:#0b0c0f;
  --panel:#11131a;
  --fg:#0e1524;
  --fg-invert:#e7eaf3;
  --muted:#6b778d;
  --muted-invert:#9aa3b2;
  --line:#dfe3ee;           /* 淺色下的邊線 */
  --line-invert:#2a3142;    /* 深色下的邊線 */
  --accent:#7aa2ff;

  --radius:14px;
  --maxw:none;              /* ✨ 移除最大寬度限制，允許水平延伸 */

  /* 統一縮排參數 */
  --indent: 28px;           /* 每一層的統一縮排寬度 */

  /* 折疊樹狀視覺 */
  --gutter: 20px;           /* 左側作用區寬（含圓點與導軌） */
  --rail-w: 1.5px;          /* 連接直線寬度 */
  --bullet-size: 8px;       /* 空心/實心點的外徑（兩者相同） */
  --rail: #dbe1f1;          /* 直線顏色（亮） */
  --bullet: #6b778d;        /* 點顏色（亮） */

  /* 圓點水平微調（負值往左、正值往右） */
  --bullet-nudge-x: -2px;

  /* 直線端點與圓點的安全距（避免穿出圓點） */
  --rail-cap: -5px;

  /* ✨ 有子層級標題 hover 顏色（淺藍） */
  --heading-hover:#9ec5ff;
}

@media (prefers-color-scheme: dark){
:root{
  --fg:#e7eaf3;
  --muted:#9aa3b2;
  --line:#262b36;
  --rail:#2a3142;
  --bullet:#9aa3b2;

  /* 深色模式下的 hover 顏色可再亮一點 */
  --heading-hover:#009AFF;
}
}

html,body{
  height:100%;
  /* ✨ 允許水平捲動 */
  overflow-x: auto;
  overflow-y: auto;
}
body{
  margin:0;
  color:var(--fg);
  font:16px/1.65 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans TC",sans-serif;
  background:#fff;
}
@media (prefers-color-scheme: dark){
  body{ background:linear-gradient(180deg,var(--bg),#0f131d); }
}

/* ✨ 移除最大寬度限制，允許內容水平延伸 */
.wrap{
  max-width: none;
  margin:0 auto;
  padding:20px 16px 60px;
  /* ✨ 確保水平捲動 */
  overflow-x: auto;
  overflow-y: visible;
}

/* 可依需求隱藏頁首與標題列 */
.hdr{ display:none; }
.titlebar{ display:none; }

/* 卡片容器 */
.card{
  background: transparent; /* ✨ 透明背景 */
  border: none;            /* ✨ 移除邊框 */
  border-radius: 0;        /* ✨ 移除圓角 */
  box-shadow: none;        /* ✨ 移除陰影 */
  overflow: visible;
  min-width: min-content;
  width: fit-content;
}
@media (prefers-color-scheme: dark){
  .card{ background: transparent; border: none; }
}
.content{
  padding: 0; /* ✨ 移除內距，讓內容完全自由延伸 */
  min-width: min-content;
  width: fit-content;
  overflow: visible;
}

/* Markdown 文字排版（精簡） */
.md-root h1{
  font-size:28px;
  margin:12px 0 14px;
  max-width: 80vw; /* ✨ 限制最大寬度為 80vw（標題不至於太長） */
  word-wrap: break-word;
  overflow-wrap: break-word;
}
.md-root p{
  margin:10px 0;
  /* ✨ 最大寬度使用視窗百分比 */
  max-width: 80vw;
  word-wrap: break-word;
  overflow-wrap: break-word;
  white-space: normal;
}
.md-root img{
  max-width: 80vw; /* ✨ 限制圖片最大寬度為視窗的 80% */
  height:auto;
  display:block;
  margin:10px auto;
  border-radius:8px;
}
pre{
  background:#0001;
  padding:12px;
  border-radius:8px;
  /* ✨ 程式碼區塊也遵守寬度限制 */
  max-width: 80vw;
  overflow-x: auto;
  word-wrap: break-word;
}

/* 取消瀏覽器預設清單縮排，交給 .section 控制縮排 */
.md-root ul, .md-root ol{
  list-style-position: outside;
  padding-left: 0;
  margin-left: 0;
}

/* ===========================
   Roam 風樹狀：連貫直線＋空心/實心點＋統一縮排
   =========================== */

/* .section 由 JS 包裝：每個可折疊節點一個 .section
   JS 會在 .section 上設定 style="--depth:N"
   使用 margin-left 以固定每層距離，不讓 ul/ol 自己疊加 */
.section{
  position: relative;
  margin-left: var(--indent);
  padding-left: var(--gutter);
  /* ✨ 讓樹狀本體可實際變寬，觸發水平滾動 */
  min-width: fit-content;
  /* ✅ 刪除 max-width 限制，避免被擠窄 */
}

/* 最外層（depth=0）不需要額外的 margin */
.section[style*="--depth: 0"]{
  margin-left: 0;
}

/* 讓 body 能當作導軌定位容器 */
.section-body{
  position: relative;
  /* ✨ 讓子內容可實際超過視窗寬（外部用水平滾動承接） */
  min-width: fit-content;
  /* ✅ 刪除 max-width 限制 */
}

/* 左側導軌（rail）— 只有「展開」且「有子層級」才顯示
   導軌畫在 body 內，並在上下端留出 --rail-cap 避免穿出圓點 */
.section-body::before{
  content:"";
  position:absolute;
  /* 從 body 的視角往左推回到「樹狀導軌中心」 */
  left: calc(-1 * var(--gutter) + (var(--gutter) / 2) - (var(--rail-w) / 2));
  top: var(--rail-cap);          /* 上端離開第一個圓點 */
  bottom: var(--rail-cap);       /* 下端離開最後一個圓點 */
  width: var(--rail-w);
  background: var(--rail);
  pointer-events: none;
  z-index: 0;
  display: none;                 /* 預設不顯示 */
}

/* ✅ 展開 + 有子層級 → 顯示導軌 */
.section.expanded.has-children > .section-body::before{
  display: block;
}

/* 標題列的版面（heading 的字級在 index.html 的 <style> 中設定） */
.section > [role="heading"]{
  position: relative;
  z-index: 1;
  transition: color .15s ease;   /* ✨ 平滑過渡 */
  /* ✅ 不再限制寬度，由內文元素控制換行 */
  max-width: none;
  word-wrap: break-word;
  overflow-wrap: break-word;
  white-space: normal;
  min-width: fit-content;
}

/* ✨ 有子層級的項目：滑鼠移入或鍵盤聚焦時變淺藍，離開恢復 */
.section.has-children > [role="heading"]:hover,
.section.has-children > [role="heading"]:focus-visible{
  color: var(--heading-hover);
  outline: none;                 /* 交給 focus-visible 顏色提示即可 */
}

/* 內容收合狀態（JS 會切換 .collapsed） */
.section-body.collapsed{ display:none; }

/* 內容區塊一致的上下距 */
.section-body > *{ margin-block: .35rem .35rem; }

/* 讓圖像不會壓到左側樹狀區 */
.section-body img{
  margin-left: .25rem;
  /* 內文圖片仍以 80vw 限制，避免過寬 */
  max-width: 80vw;
}

/* section-body 內的段落和文字內容 */
.section-body p,
.section-body > *:not(.section):not(ul):not(ol) {
  max-width: 80vw;               /* 內文依舊維持可讀性寬度 */
  word-wrap: break-word;
  overflow-wrap: break-word;
  white-space: normal;           /* ✨ 允許換行 */
}

/* section-body 內的 ul/ol 不要再縮排，因為 li 會被轉成 .section */
.section-body ul, .section-body ol{
  padding-left: 0;
  margin-left: 0;
  list-style: none;
}

/* 如果 section-body 內仍有原生 li（理論上不會），給予縮排避免貼齊 */
.section-body li{
  margin-left: var(--indent);
  /* ✅ 刪除 max-width 限制，避免樹狀被擠窄 */
  word-wrap: break-word;
}

/* 連結風格 */
.md-root a{
  color:var(--accent);
  text-decoration:none;
  word-wrap: break-word;
  overflow-wrap: break-word;
}
.md-root a:hover{ text-decoration:underline; }

/* ✨ 捲軸樣式美化（可選） */
::-webkit-scrollbar { width: 10px; height: 10px; }
::-webkit-scrollbar-track { background: rgba(0,0,0,0.05); }
::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.2); border-radius: 5px; }
::-webkit-scrollbar-thumb:hover { background: rgba(0,0,0,0.3); }

@media (prefers-color-scheme: dark){
  ::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); }
  ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); }
  ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.3); }
}
